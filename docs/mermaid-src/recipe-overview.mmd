graph TB
    subgraph INPUTS["Raw Inputs"]
        CHARCOAL["Charcoal<br/>(foraged, crafted,<br/>or methanol byproduct)"]
        CROPS["Crops: Soybeans, Sunflower,<br/>Corn, Flax, Hemp, Peanuts"]
        FATS["Lard / Butter / Margarine"]
        OILS["OilVegetable / OilOlive"]
        MEAT["Butchered Meat<br/>(any cut)"]
        WOOD["Wood<br/>(Plank / Firewood)"]
        BONES["Animal Bones / Skulls"]
        COMPOST["CompostBag / Animal Dung"]
        BATTERY["Car Battery"]
        FERT["Fertilizer"]
        QLIME["Quicklime"]
    end

    subgraph BP["Blackpowder Pathway (Steps 1-7)"]
        CRUSH["CrushedCharcoal"]
        PURIFY["PurifiedCharcoal"]
        POTASH["Potash"]
        KNO3["KNO3 Powder"]
        SULPHUR["SulphurPowder"]
        GUNPOWDER["GunPowder"]
    end

    subgraph BD["Biodiesel Pathway (Steps 1-5)"]
        CRUDE_OIL["CrudeVegetableOil"]
        RENDERED["RenderedFat"]
        METHANOL["WoodMethanol"]
        KOH["KOH"]
        CRUDE_BD["CrudeBiodiesel"]
        WASHED_BD["WashedBiodiesel"]
        REFINED_BD["RefinedBiodieselCan<br/>(5L Petrol)"]
    end

    subgraph BY["By-Products"]
        WOODTAR["WoodTar"]
        CALCITE["Calcite"]
        GLYCEROL["Glycerol"]
        SOAP["CrudeSoap"]
    end

    subgraph BC["Bone Char"]
        BONECHAR["BoneChar"]
    end

    subgraph UTIL["Utility"]
        DCOMPOST["DilutedCompost"]
        H2SO4["SulphuricAcid"]
        LEAD["LeadScrap"]
        PLASTIC["PlasticScrap"]
        ACIDWASH["AcidWashedElectronics"]
    end

    subgraph RC["Recycling Pathway (R1-R9)"]
        WOODGLUE["WoodGlue (R1)"]
        QLIME_OUT["Quicklime (R2)"]
        FERT_OUT["Fertilizer (R3)"]
        FERT_S_OUT["Fertilizer ×3 (R3b)<br/>Sulphur-Enhanced"]
        FERT_P_OUT["Fertilizer ×2 (R3c)<br/>Potash"]
        SOAP2["Soap (R4)"]
        BANDAGE["Sterilized Bandages (R5)"]
        TACKLE["FishingHook_Forged (R6)"]
        GLUE["Glue (R7)"]
        TRANSISTOR["Transistor + Amplifier (R8)"]
        TORCH_OUT["Torch ×2 (R9)"]
    end

    CHARCOAL --> CRUSH
    CRUSH --> PURIFY
    PURIFY -.-> POTASH
    COMPOST --> DCOMPOST
    DCOMPOST --> KNO3
    FERT --> KNO3
    PURIFY --> KNO3
    BATTERY --> H2SO4
    H2SO4 --> SULPHUR
    PURIFY --> SULPHUR
    KNO3 --> GUNPOWDER
    SULPHUR --> GUNPOWDER
    PURIFY --> GUNPOWDER

    CROPS --> CRUDE_OIL
    OILS --> CRUDE_OIL
    FATS --> RENDERED
    MEAT --> RENDERED
    WOOD --> METHANOL
    METHANOL -.-> CHARCOAL
    POTASH --> KOH
    QLIME --> KOH
    CRUDE_OIL --> CRUDE_BD
    RENDERED --> CRUDE_BD
    METHANOL --> CRUDE_BD
    KOH --> CRUDE_BD
    CRUDE_BD --> WASHED_BD
    WASHED_BD --> REFINED_BD

    METHANOL -.-> WOODTAR
    KOH -.-> CALCITE
    CRUDE_BD -.-> GLYCEROL
    GLYCEROL --> SOAP
    RENDERED --> SOAP

    BONES --> BONECHAR
    BONECHAR -.->|"alt for PurifiedCharcoal"| PURIFY

    BATTERY --> LEAD

    %% Recycling chain
    WOODTAR --> WOODGLUE
    WOODTAR --> TORCH_OUT
    CALCITE --> QLIME_OUT
    CALCITE --> FERT_OUT
    CALCITE --> FERT_S_OUT
    SULPHUR --> FERT_S_OUT
    POTASH --> FERT_P_OUT
    SOAP --> SOAP2
    SOAP --> BANDAGE
    LEAD --> TACKLE
    PLASTIC --> GLUE
    ACIDWASH --> TRANSISTOR

    subgraph AG["Agriculture & Downstream (Pathways A-F)"]
        SPRAY_S["SulphurFungicideSpray<br/>(cures Mildew)"]
        SPRAY_I["InsecticidalSoapSpray<br/>(cures Aphids)"]
        SPRAY_P["PotashFoliarSpray<br/>(cures Flies)"]
        FEED["Feed Supplement"]
        WATER["Water Purification<br/>Tablets + Filters"]
        EPOXY["Epoxy Resin"]
        FIRE["Fire Starters<br/>Lighter Fluid, Matchboxes"]
        TANNING["Chemical Tanning<br/>Leather"]
        PLASTER["Plaster Powder"]
    end

    SULPHUR --> SPRAY_S
    SOAP --> SPRAY_I
    POTASH --> SPRAY_P
    BONECHAR --> FEED
    CALCITE --> FEED
    PURIFY --> WATER
    BONECHAR --> WATER
    WOODTAR --> EPOXY
    GLYCEROL --> EPOXY
    WOODTAR --> FIRE
    PURIFY --> TANNING
    CALCITE --> PLASTER
    QLIME --> PLASTER

    subgraph MX["Concrete Mixer (13 recipes)"]
        MX_CONCRETE["Concrete<br/>(2x BucketConcreteFull)"]
        MX_CLAY["Clay Cement<br/>(2x BucketClayCement)"]
        MX_MORTAR["Mortar Mix<br/>(2x MortarMix)"]
        MX_STUCCO["Stucco Mix<br/>(2x StuccoMix)"]
        MX_REINF["Reinforced Concrete<br/>(2x ReinforcedConcrete)"]
        MX_FIRE["Fireclay<br/>(2x Fireclay)"]
        MX_BP["Bulk Blackpowder<br/>(3x GunPowder)"]
        MX_BD["Bulk Biodiesel<br/>(CrudeBiodieselBucket)"]
        MX_SOAP["Bulk Soap<br/>(4x CrudeSoap)"]
        MX_COMP["Bulk Compost<br/>(3x DilutedCompost)"]
        MX_PLASTER["Plaster Powder<br/>(2x PlasterPowder)"]
        MX_VINEGAR["Wood Vinegar<br/>(Vinegar)"]
    end

    SULPHUR --> MX_BP
    KNO3 --> MX_BP
    PURIFY --> MX_BP
    CRUDE_OIL --> MX_BD
    METHANOL --> MX_BD
    KOH --> MX_BD
    RENDERED --> MX_SOAP
    KOH --> MX_SOAP
    COMPOST --> MX_COMP
    BONECHAR --> MX_COMP
    CALCITE --> MX_MORTAR
    CALCITE --> MX_PLASTER
    WOODTAR --> MX_VINEGAR
    MX_CONCRETE --> MX_REINF

    style MX fill:#668,color:#fff
    style GUNPOWDER fill:#c44,color:#fff
    style REFINED_BD fill:#4a4,color:#fff
    style SOAP fill:#48c,color:#fff
    style BONECHAR fill:#864,color:#fff
    style RC fill:#654,color:#fff
    style AG fill:#486,color:#fff
